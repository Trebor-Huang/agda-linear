-- An abandoned effort
-- This is subsumed by the other modules
-- Therefore I am justified to not leave any more explanation here

module Syntax where

data Â± : Set where
    + : Â±
    - : Â±

data ğ•‹ : Â± -> Set where
    _âŠ—_ : ğ•‹ + -> ğ•‹ + -> ğ•‹ +
    _âŠ•_ : ğ•‹ + -> ğ•‹ + -> ğ•‹ +
    _&_ : ğ•‹ - -> ğ•‹ - -> ğ•‹ -
    _â…‹_ : ğ•‹ - -> ğ•‹ - -> ğ•‹ -
    ğŸ™ : ğ•‹ +
    ğŸ˜ : ğ•‹ +
    âŠ¤ : ğ•‹ -
    âŠ¥ : ğ•‹ -
    â†‘_ : ğ•‹ + -> ğ•‹ -
    â†“_ : ğ•‹ - -> ğ•‹ +
    Â¬âº_ : ğ•‹ + -> ğ•‹ +
    Â¬â»_ : ğ•‹ - -> ğ•‹ -

infixl 8 _âŠ—_
infixl 8 _âŠ•_
infixl 8 _&_
infixl 8 _â…‹_

infix 9 â†‘_
infix 9 â†“_
infix 9 Â¬âº_
infix 9 Â¬â»_

data T : Set where
    â–¹ : âˆ€ {p} -> ğ•‹ p -> T
    â—ƒ : âˆ€ {p} -> ğ•‹ p -> T

data J : Set where
    :- : T -> J
    # : J

data Pattern : âˆ€ p -> ğ•‹ p -> Set where
    âŸ¨_,_âŸ© : âˆ€ {A B} -> Pattern + A -> Pattern + B -> Pattern + (A âŠ— B)
    Ï–â‚ : âˆ€ {A B} -> Pattern + A -> Pattern + (A âŠ• B)
    Ï–â‚‚ : âˆ€ {A B} -> Pattern + B -> Pattern + (A âŠ• B)
    âŸª_,_âŸ« : âˆ€ {A B} -> Pattern - A -> Pattern - B -> Pattern - (A â…‹ B)
    Ï€â‚ : âˆ€ {A B} -> Pattern - A -> Pattern - (A & B)
    Ï€â‚‚ : âˆ€ {A B} -> Pattern - B -> Pattern - (A & B)
    *Ì‚ : Pattern + ğŸ™
    *Ì¬ : Pattern - âŠ¥
    â‡‘ : âˆ€ { A : ğ•‹ + } -> Pattern - (â†‘ A)
    â‡“ : âˆ€ { A : ğ•‹ - } -> Pattern + (â†“ A)
    â—âº : âˆ€ { A : ğ•‹ + } -> Pattern + (Â¬âº A)
    â—â» : âˆ€ { A : ğ•‹ - } -> Pattern - (Â¬â» A)

data _âˆ‹Ì‚_ : âˆ€ {p A} -> Pattern p A -> T -> Set where
    âŸ¨_,~âŸ© : âˆ€ {A B t} {p : Pattern + A} {q : Pattern + B} -> p âˆ‹Ì‚ t -> âŸ¨ p , q âŸ© âˆ‹Ì‚ t
    âŸ¨~,_âŸ© : âˆ€ {A B t} {p : Pattern + A} {q : Pattern + B} -> q âˆ‹Ì‚ t -> âŸ¨ p , q âŸ© âˆ‹Ì‚ t
    ~Ï–â‚ : âˆ€ {A B t} {p : Pattern + A} -> p âˆ‹Ì‚ t -> Ï–â‚ {B = B} p âˆ‹Ì‚ t
    ~Ï–â‚‚ : âˆ€ {A B t} {p : Pattern + B} -> p âˆ‹Ì‚ t -> Ï–â‚‚ {A = A} p âˆ‹Ì‚ t
    âŸª_,~âŸ« : âˆ€ {A B t} {p : Pattern - A} {q : Pattern - B} -> p âˆ‹Ì‚ t -> âŸª p , q âŸ« âˆ‹Ì‚ t
    âŸª~,_âŸ« : âˆ€ {A B t} {p : Pattern - A} {q : Pattern - B} -> q âˆ‹Ì‚ t -> âŸª p , q âŸ« âˆ‹Ì‚ t
    ~Ï€â‚ : âˆ€ {A B t} {p : Pattern - A} -> p âˆ‹Ì‚ t -> Ï€â‚ {B = B} p âˆ‹Ì‚ t
    ~Ï€â‚‚ : âˆ€ {A B t} {p : Pattern - B} -> p âˆ‹Ì‚ t -> Ï€â‚‚ {A = A} p âˆ‹Ì‚ t
    ~â‡‘ : âˆ€ { A : ğ•‹ + } -> â‡‘ {A} âˆ‹Ì‚ â–¹ A
    ~â‡“ : âˆ€ { A : ğ•‹ - } -> â‡“ {A} âˆ‹Ì‚ â—ƒ A
    ~â—âº : âˆ€ {A} -> â—âº {A} âˆ‹Ì‚ â—ƒ A
    ~â—â» : âˆ€ {A} -> â—â» {A} âˆ‹Ì‚ â–¹ A

infix 6 _âˆ‹Ì‚_

-- Contexts should respect the structure of bindings
-- Everyone got to be somewhere!

-- Records the Occurence
data Occurs : âˆ€ {p A} -> Pattern p A -> Set where
    ^âŸ¨_,_âŸ© : âˆ€ {A B} {p : Pattern _ A} {q : Pattern _ B} -> Occurs p -> Occurs q -> Occurs âŸ¨ p , q âŸ©
    ^Ï–â‚ : âˆ€ {A B} {p : Pattern _ A} -> Occurs p -> Occurs (Ï–â‚ {B = B} p)
    ^Ï–â‚‚ : âˆ€ {A B} {p : Pattern _ B} -> Occurs p -> Occurs (Ï–â‚‚ {A = A} p)
    ^âŸª_,_âŸ« : âˆ€ {A B} {p : Pattern _ A} {q : Pattern _ B} -> Occurs p -> Occurs q -> Occurs âŸª p , q âŸ«
    ^Ï€â‚ : âˆ€ {A B} {p : Pattern _ A} -> Occurs p -> Occurs (Ï€â‚ {B = B} p)
    ^Ï€â‚‚ : âˆ€ {A B} {p : Pattern _ B} -> Occurs p -> Occurs (Ï€â‚‚ {A = A} p)
    ^*Ì‚ : Occurs *Ì‚
    ^*Ì¬ : Occurs *Ì¬
    â–¡â‡‘ : âˆ€ { A : ğ•‹ + } -> Occurs (â‡‘ {A})
    â– â‡‘ : âˆ€ { A : ğ•‹ + } -> Occurs (â‡‘ {A})
    â–¡â—âº : âˆ€ { A : ğ•‹ + } -> Occurs (â—âº {A})
    â– â—âº : âˆ€ { A : ğ•‹ + } -> Occurs (â—âº {A})
    â–¡â‡“ : âˆ€ { A : ğ•‹ - } -> Occurs (â‡“ {A})
    â– â‡“ : âˆ€ { A : ğ•‹ - } -> Occurs (â‡“ {A})
    â–¡â—â» : âˆ€ { A : ğ•‹ - } -> Occurs (â—â» {A})
    â– â—â» : âˆ€ { A : ğ•‹ - } -> Occurs (â—â» {A})

-- Disjoint union of occurrences
data _âŠ_â‰…_ : âˆ€ {pol A}{p : Pattern pol A} -> Occurs p -> Occurs p -> Occurs p -> Set where
    âŠâŸ¨_,_âŸ© : âˆ€{A B}{ p : Pattern _ A }{ q : Pattern _ B }{ Î”â‚ Î”â‚‚ Î”â‚ƒ : Occurs p }{ Î“â‚ Î“â‚‚ Î“â‚ƒ : Occurs q}
        -> Î”â‚ âŠ Î”â‚‚ â‰… Î”â‚ƒ -> Î“â‚ âŠ Î“â‚‚ â‰… Î“â‚ƒ -> ^âŸ¨ Î”â‚ , Î“â‚ âŸ© âŠ ^âŸ¨ Î”â‚‚ , Î“â‚‚ âŸ© â‰… ^âŸ¨ Î”â‚ƒ , Î“â‚ƒ âŸ©
    âŠÏ–â‚ : âˆ€{A B}{ p : Pattern + A }{ Î”â‚ Î”â‚‚ Î”â‚ƒ : Occurs p }
        -> Î”â‚ âŠ Î”â‚‚ â‰… Î”â‚ƒ -> ^Ï–â‚ Î”â‚ âŠ ^Ï–â‚ Î”â‚‚ â‰… ^Ï–â‚ {B = B} Î”â‚ƒ
    âŠÏ–â‚‚ : âˆ€{A B}{ p : Pattern + B }{ Î”â‚ Î”â‚‚ Î”â‚ƒ : Occurs p }
        -> Î”â‚ âŠ Î”â‚‚ â‰… Î”â‚ƒ -> ^Ï–â‚‚ Î”â‚ âŠ ^Ï–â‚‚ Î”â‚‚ â‰… ^Ï–â‚‚ {A = A} Î”â‚ƒ
    âŠâŸª_,_âŸ« : âˆ€{A B}{ p : Pattern _ A }{ q : Pattern _ B }{ Î”â‚ Î”â‚‚ Î”â‚ƒ : Occurs p }{ Î“â‚ Î“â‚‚ Î“â‚ƒ : Occurs q}
        -> Î”â‚ âŠ Î”â‚‚ â‰… Î”â‚ƒ -> Î“â‚ âŠ Î“â‚‚ â‰… Î“â‚ƒ -> ^âŸª Î”â‚ , Î“â‚ âŸ« âŠ ^âŸª Î”â‚‚ , Î“â‚‚ âŸ« â‰… ^âŸª Î”â‚ƒ , Î“â‚ƒ âŸ«
    âŠÏ€â‚ : âˆ€{A B}{ p : Pattern - A }{ Î”â‚ Î”â‚‚ Î”â‚ƒ : Occurs p }
        -> Î”â‚ âŠ Î”â‚‚ â‰… Î”â‚ƒ -> ^Ï€â‚ Î”â‚ âŠ ^Ï€â‚ Î”â‚‚ â‰… ^Ï€â‚ {B = B} Î”â‚ƒ
    âŠÏ€â‚‚ : âˆ€{A B}{ p : Pattern - B }{ Î”â‚ Î”â‚‚ Î”â‚ƒ : Occurs p }
        -> Î”â‚ âŠ Î”â‚‚ â‰… Î”â‚ƒ -> ^Ï€â‚‚ Î”â‚ âŠ ^Ï€â‚‚ Î”â‚‚ â‰… ^Ï€â‚‚ {A = A} Î”â‚ƒ
    âŠ*Ì‚ : ^*Ì‚ âŠ ^*Ì‚ â‰… ^*Ì‚
    âŠ*Ì¬ : ^*Ì¬ âŠ ^*Ì¬ â‰… ^*Ì¬
    âŠâ‡‘L : âˆ€{A} -> â– â‡‘ âŠ â–¡â‡‘ â‰… â– â‡‘ {A}
    âŠâ‡‘R : âˆ€{A} -> â–¡â‡‘ âŠ â– â‡‘ â‰… â– â‡‘ {A}
    âŠâ‡‘â–¡ : âˆ€{A} -> â–¡â‡‘ âŠ â–¡â‡‘ â‰… â–¡â‡‘ {A}
    âŠâ‡“L : âˆ€{A} -> â– â‡“ âŠ â–¡â‡“ â‰… â– â‡“ {A}
    âŠâ‡“R : âˆ€{A} -> â–¡â‡“ âŠ â– â‡“ â‰… â– â‡“ {A}
    âŠâ‡“â–¡ : âˆ€{A} -> â–¡â‡“ âŠ â–¡â‡“ â‰… â–¡â‡“ {A}
    âŠâ—âºL : âˆ€{A} -> â– â—âº âŠ â–¡â—âº â‰… â– â—âº {A}
    âŠâ—âºR : âˆ€{A} -> â–¡â—âº âŠ â– â—âº â‰… â– â—âº {A}
    âŠâ—âºâ–¡ : âˆ€{A} -> â–¡â—âº âŠ â–¡â—âº â‰… â–¡â—âº {A}
    âŠâ—â»L : âˆ€{A} -> â– â—â» âŠ â–¡â—â» â‰… â– â—â» {A}
    âŠâ—â»R : âˆ€{A} -> â–¡â—â» âŠ â– â—â» â‰… â– â—â» {A}
    âŠâ—â»â–¡ : âˆ€{A} -> â–¡â—â» âŠ â–¡â—â» â‰… â–¡â—â» {A}

-- Auxiliary functions to construct occurrences
â–  : âˆ€ {pol A} -> (p : Pattern pol A) -> Occurs p
â–  âŸ¨ p , q âŸ© = ^âŸ¨ â–  p , â–  q âŸ©
â–  (Ï–â‚ p) = ^Ï–â‚ (â–  p)
â–  (Ï–â‚‚ p) = ^Ï–â‚‚ (â–  p)
â–  âŸª p , q âŸ« = ^âŸª â–  p , â–  q âŸ«
â–  (Ï€â‚ p) = ^Ï€â‚ (â–  p)
â–  (Ï€â‚‚ p) = ^Ï€â‚‚ (â–  p)
â–  *Ì‚ = ^*Ì‚
â–  *Ì¬ = ^*Ì¬
â–  â‡‘ = â– â‡‘
â–  â‡“ = â– â‡“
â–  â—âº = â– â—âº
â–  â—â» = â– â—â»

â–¡ : âˆ€ {pol A} -> (p : Pattern pol A) -> Occurs p
â–¡ âŸ¨ p , q âŸ© = ^âŸ¨ â–¡ p , â–¡ q âŸ©
â–¡ (Ï–â‚ p) = ^Ï–â‚ (â–¡ p)
â–¡ (Ï–â‚‚ p) = ^Ï–â‚‚ (â–¡ p)
â–¡ âŸª p , q âŸ« = ^âŸª â–¡ p , â–¡ q âŸ«
â–¡ (Ï€â‚ p) = ^Ï€â‚ (â–¡ p)
â–¡ (Ï€â‚‚ p) = ^Ï€â‚‚ (â–¡ p)
â–¡ *Ì‚ = ^*Ì‚
â–¡ *Ì¬ = ^*Ì¬
â–¡ â‡‘ = â–¡â‡‘
â–¡ â‡“ = â–¡â‡“
â–¡ â—âº = â–¡â—âº
â–¡ â—â» = â–¡â—â»


focus : âˆ€ {pol A B} -> (p : Pattern pol A) -> p âˆ‹Ì‚ B -> Occurs p
focus âŸ¨ p , q âŸ© âŸ¨ Î± ,~âŸ© = ^âŸ¨ focus p Î± , â–¡ q âŸ©
focus âŸ¨ p , q âŸ© âŸ¨~, Î± âŸ© = ^âŸ¨ â–¡ p , focus q Î± âŸ©
focus (Ï–â‚ p) (~Ï–â‚ Î±) = ^Ï–â‚ (focus p Î±)
focus (Ï–â‚‚ p) (~Ï–â‚‚ Î±) = ^Ï–â‚‚ (focus p Î±)
focus âŸª p , q âŸ« âŸª Î± ,~âŸ« = ^âŸª (focus p Î±) , â–¡ q âŸ«
focus âŸª p , q âŸ« âŸª~, Î± âŸ« = ^âŸª â–¡ p , (focus q Î±) âŸ«
focus (Ï€â‚ p) (~Ï€â‚ Î±) = ^Ï€â‚ (focus p Î±)
focus (Ï€â‚‚ p) (~Ï€â‚‚ Î±) = ^Ï€â‚‚ (focus p Î±)
focus â‡‘ ~â‡‘ = â– â‡‘
focus â‡“ ~â‡“ = â– â‡“
focus â—âº ~â—âº = â– â—âº
focus â—â» ~â—â» = â– â—â»


-- Now we can properly write some linear code
-- Contexts indicates usage while Stack doesn't

data Stack : Set where
    âˆ… : Stack
    _âˆ¶_ : âˆ€ {pol A} -> Stack -> Pattern pol A -> Stack

data Context : Stack -> Set where
    Îµ : Context âˆ…
    _âˆ·_ : âˆ€ {pol A}{p : Pattern pol A}{Î£} -> Context Î£ -> Occurs p -> Context (Î£ âˆ¶ p)

infix 6 _âŠ_â‰…_
infixl 6 _âˆ·_ _âˆ¶_
infix 5 _âŠâŠ_â‰…â‰…_

-- Extend âŠ to contexts
data _âŠâŠ_â‰…â‰…_ : âˆ€ {Î£} -> Context Î£ -> Context Î£ -> Context Î£ -> Set where
    âŠâŠÎµ : Îµ âŠâŠ Îµ â‰…â‰… Îµ
    âŠâŠâˆ· : âˆ€ {Î£ pol A} {p : Pattern pol A} {Î“â‚ Î“â‚‚ Î“â‚ƒ : Context Î£} {Î”â‚ Î”â‚‚ Î”â‚ƒ : Occurs p}
        -> Î“â‚ âŠâŠ Î“â‚‚ â‰…â‰… Î“â‚ƒ -> Î”â‚ âŠ Î”â‚‚ â‰… Î”â‚ƒ
        -> Î“â‚ âˆ· Î”â‚ âŠâŠ Î“â‚‚ âˆ· Î”â‚‚ â‰…â‰… Î“â‚ƒ âˆ· Î”â‚ƒ

-- Extend â–¡ to contexts
â–¡Ì‚ : âˆ€ Î£ -> Context Î£
â–¡Ì‚ âˆ… = Îµ
â–¡Ì‚ (Î£ âˆ¶ Î±) = (â–¡Ì‚ Î£) âˆ· â–¡ Î±

â– Ì‚ : âˆ€ Î£ -> Context Î£
â– Ì‚ âˆ… = Îµ
â– Ì‚ (Î£ âˆ¶ Î±) = (â– Ì‚ Î£) âˆ· â–  Î±

infix 5 _âˆ‹_

data _âˆ‹_ : âˆ€ {Î£} -> Context Î£ -> T -> Set where
    sÌ‚_ : âˆ€ {Î£ pol'} {A : T} {B : ğ•‹ pol'} {p} {Î“ : Context Î£} {Î”}
        -> Î“ âˆ‹ A -> (_âˆ·_ {A = B} {p = p} Î“ Î”) âˆ‹ A
    zÌ‚_ : âˆ€ {Î£ pol'} {A : T} {B : ğ•‹ pol'} {p}
        -> (Î± : p âˆ‹Ì‚ A) -> (_âˆ·_ {A = B} {p = p} (â–¡Ì‚ Î£) (focus p Î±)) âˆ‹ A

infixr 9 sÌ‚_ zÌ‚_

-- Sanity Check
ğ”¹ : ğ•‹ +
ğ”¹ = (ğŸ™ âŠ• ğŸ™)

ğ•— : Pattern + ğ”¹
ğ•— = Ï–â‚ *Ì‚

ğ•¥ : Pattern + ğ”¹
ğ•¥ = Ï–â‚‚ *Ì‚

-- For the normal terms!
data _âŠ¨_ : âˆ€ {Î£} -> Context Î£ -> J -> Set
data _âŠ¨âŠ¨_ : âˆ€ {Î£} -> Context Î£ -> âˆ€ {pol A} (p : Pattern pol A) -> Set

infix 5 _âŠ¨_ _âŠ¨âŠ¨_

data _âŠ¨_ where
    _âŸ¦_âŸ§âº : âˆ€ {Î£} {Î“ :Â Context Î£} { A : ğ•‹ + }
        -> (Î” : Pattern + A)
        -> Î“ âŠ¨âŠ¨ Î”
        -> Î“ âŠ¨ :- (â–¹ A)
    _âŸ¦_âŸ§â» : âˆ€ {Î£} {Î“ :Â Context Î£} { A : ğ•‹ - }
        -> (Î” : Pattern - A)
        -> Î“ âŠ¨âŠ¨ Î”
        -> Î“ âŠ¨ :- (â—ƒ A)
    caseâº : âˆ€ {Î£} {Î“ :Â Context Î£} { A : ğ•‹ + }
        -> ((Î” : Pattern + A) -> (Î“ âˆ· â–  Î”) âŠ¨ #)
        -> Î“ âŠ¨ :- (â—ƒ A)
    caseâ» : âˆ€ {Î£} {Î“ :Â Context Î£} { A : ğ•‹ - }
        -> ((Î” : Pattern - A) -> (Î“ âˆ· â–  Î”) âŠ¨ #)
        -> Î“ âŠ¨ :- (â–¹ A)
    var : âˆ€ {Î£} {Î“ : Context Î£} { A : T }
        -> Î“ âˆ‹ A -> Î“ âŠ¨ :- A
    _#âº_ : âˆ€ {Î£} {Î“ Î“* Î“' : Context Î£} { A : ğ•‹ + }
        -> {Ïƒ : Î“ âŠâŠ Î“* â‰…â‰… Î“'}
        -> (vâº : Î“* âˆ‹ â—ƒ A)
        -> Î“ âŠ¨ :- (â–¹ A)
        -> Î“' âŠ¨ #
    _#â»_ : âˆ€ {Î£} {Î“ Î“* Î“' : Context Î£} { A : ğ•‹ - }
        -> {Ïƒ : Î“ âŠâŠ Î“* â‰…â‰… Î“'}
        -> (vâ» : Î“* âˆ‹ â–¹ A)
        -> Î“ âŠ¨ :- (â—ƒ A)
        -> Î“' âŠ¨ #

infix 6 _#âº_ _#â»_
infix 7 _âŸ¦_âŸ§âº _âŸ¦_âŸ§â»

data _âŠ¨âŠ¨_ where  -- Just Pattern -> _âŠ¨_
    âŠ¨âŠ¨*Ì‚ : âˆ€ {Î£} -> â–¡Ì‚ Î£ âŠ¨âŠ¨ *Ì‚
    âŠ¨âŠ¨*Ì¬ : âˆ€ {Î£} -> â–¡Ì‚ Î£ âŠ¨âŠ¨ *Ì¬
    âŠ¨âŠ¨â‡‘ : âˆ€ {Î£ Aâº} {Î“ : Context Î£}
        -> Î“ âŠ¨ :- (â—ƒ Aâº) -> Î“ âŠ¨âŠ¨ â‡‘ {A = Aâº}
    âŠ¨âŠ¨â‡“ : âˆ€ {Î£ Aâ»} {Î“ : Context Î£}
        -> Î“ âŠ¨ :- (â–¹ Aâ») -> Î“ âŠ¨âŠ¨ â‡“ {A = Aâ»}
    âŠ¨âŠ¨â—âº : âˆ€ {Î£ Aâº} {Î“ : Context Î£}
        -> Î“ âŠ¨ :- (â—ƒ Aâº) -> Î“ âŠ¨âŠ¨ â—âº {A = Aâº}
    âŠ¨âŠ¨â—â» : âˆ€ {Î£ Aâ»} {Î“ : Context Î£}
        -> Î“ âŠ¨ :- (â–¹ Aâ») -> Î“ âŠ¨âŠ¨ â—â» {A = Aâ»}
    âŠ¨âŠ¨âŸ¨_,_âŸ© : âˆ€ {Î£} {Î“â‚ Î“â‚‚ Î“â‚ƒ : Context Î£} {Aâº Bâº} {p : Pattern + Aâº} {q : Pattern + Bâº}
        -> {Î“â‚ âŠâŠ Î“â‚‚ â‰…â‰… Î“â‚ƒ}
        -> Î“â‚ âŠ¨âŠ¨ p -> Î“â‚‚ âŠ¨âŠ¨ q -> Î“â‚ƒ âŠ¨âŠ¨ âŸ¨ p , q âŸ©
    âŠ¨âŠ¨âŸª_,_âŸ« : âˆ€ {Î£} {Î“â‚ Î“â‚‚ Î“â‚ƒ : Context Î£} {Aâ» Bâ»} {p : Pattern - Aâ»} {q : Pattern - Bâ»}
        -> {Î“â‚ âŠâŠ Î“â‚‚ â‰…â‰… Î“â‚ƒ}
        -> Î“â‚ âŠ¨âŠ¨ p -> Î“â‚‚ âŠ¨âŠ¨ q -> Î“â‚ƒ âŠ¨âŠ¨ âŸª p , q âŸ«
    âŠ¨âŠ¨Ï–â‚ : âˆ€ {Î£} {Î“ : Context Î£} {Aâº Bâº} {p : Pattern + Aâº}
        -> Î“ âŠ¨âŠ¨ p -> Î“ âŠ¨âŠ¨ Ï–â‚ {B = Bâº} p
    âŠ¨âŠ¨Ï–â‚‚ : âˆ€ {Î£} {Î“ : Context Î£} {Aâº Bâº} {p : Pattern + Bâº}
        -> Î“ âŠ¨âŠ¨ p -> Î“ âŠ¨âŠ¨ Ï–â‚‚ {A = Aâº} p
    âŠ¨âŠ¨Ï€â‚ : âˆ€ {Î£} {Î“ : Context Î£} {Aâ» Bâ»} {p : Pattern - Aâ»}
        -> Î“ âŠ¨âŠ¨ p -> Î“ âŠ¨âŠ¨ Ï€â‚ {B = Bâ»} p
    âŠ¨âŠ¨Ï€â‚‚ : âˆ€ {Î£} {Î“ : Context Î£} {Aâ» Bâ»} {p : Pattern - Bâ»}
        -> Î“ âŠ¨âŠ¨ p -> Î“ âŠ¨âŠ¨ Ï€â‚‚ {A = Aâ»} p

-- Some example terms

tt : Îµ âŠ¨ :- (â–¹ ğ”¹)
tt = ğ•¥ âŸ¦ âŠ¨âŠ¨Ï–â‚‚ âŠ¨âŠ¨*Ì‚ âŸ§âº

ff : Îµ âŠ¨ :- (â–¹ ğ”¹)
ff = ğ•— âŸ¦ âŠ¨âŠ¨Ï–â‚ âŠ¨âŠ¨*Ì‚ âŸ§âº

not : Îµ âˆ· (â–  (â—âº {A = ğ”¹})) âŠ¨ :- (â—ƒ ğ”¹)
not = caseâº n
    where
        n : (b : Pattern + ğ”¹) â†’ Îµ âˆ· â– â—âº âˆ· â–  b âŠ¨ #
        n (Ï–â‚ *Ì‚) = _#âº_
            {Ïƒ = âŠâŠâˆ· (âŠâŠâˆ· âŠâŠÎµ âŠâ—âºR) (âŠÏ–â‚ âŠ*Ì‚)}
            (sÌ‚ zÌ‚ ~â—âº) (ğ•¥ âŸ¦ âŠ¨âŠ¨Ï–â‚‚ âŠ¨âŠ¨*Ì‚ âŸ§âº)
        n (Ï–â‚‚ *Ì‚) = _#âº_
            {Ïƒ = âŠâŠâˆ· (âŠâŠâˆ· âŠâŠÎµ âŠâ—âºR) (âŠÏ–â‚‚ âŠ*Ì‚)}
            (sÌ‚ zÌ‚ ~â—âº) (ğ•— âŸ¦ âŠ¨âŠ¨Ï–â‚ âŠ¨âŠ¨*Ì‚ âŸ§âº)
